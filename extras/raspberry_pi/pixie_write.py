import spidev
import time
spi = spidev.SpiDev()
spi.open(0,0)
# SPI Settings
spi.max_speed_hz = 10000 # increase or decrease speed if issues occur
spi.mode = 0b01 # clock polarity and phase
spi.no_cs = True # No CS pin needed

chars = {
	" ":[0, 0, 0, 0, 0],
	"$":[36, 42, 127, 42, 18],
	"(":[0, 28, 34, 65, 0],
	",":[0, 80, 48, 0, 0],
	"0":[62, 81, 73, 69, 62],
	"4":[24, 20, 18, 127, 16],
	"8":[54, 73, 73, 73, 54],
	"<":[0, 8, 20, 34, 65],
	"@":[50, 73, 121, 65, 62],
	"D":[127, 65, 65, 34, 28],
	"H":[127, 8, 8, 8, 127],
	"L":[127, 64, 64, 64, 64],
	"P":[127, 9, 9, 9, 6],
	"T":[1, 1, 127, 1, 1],
	"X":[99, 20, 8, 20, 99],
	"\\":[2, 4, 8, 16, 32],
	"`":[0, 1, 2, 4, 0],
	"d":[56, 68, 68, 72, 127],
	"h":[127, 8, 4, 4, 120],
	"l":[0, 65, 127, 64, 0],
	"p":[124, 20, 20, 20, 8],
	"t":[4, 63, 68, 64, 32],
	"x":[68, 40, 16, 40, 68],
	"|":[0, 0, 127, 0, 0],
	"#":[20, 127, 20, 127, 20],
	"'":[0, 5, 3, 0, 0],
	"+":[8, 8, 62, 8, 8],
	"/":[32, 16, 8, 4, 2],
	"3":[33, 65, 69, 75, 49],
	"7":[1, 113, 9, 5, 3],
	";":[0, 86, 54, 0, 0],
	"?":[2, 1, 81, 9, 6],
	"C":[62, 65, 65, 65, 34],
	"G":[62, 65, 65, 81, 50],
	"K":[127, 8, 20, 34, 65],
	"O":[62, 65, 65, 65, 62],
	"S":[70, 73, 73, 73, 49],
	"W":[127, 32, 24, 32, 127],
	"[":[0, 0, 127, 65, 65],
	"_":[64, 64, 64, 64, 64],
	"c":[56, 68, 68, 68, 32],
	"g":[8, 20, 84, 84, 60],
	"k":[0, 127, 16, 40, 68],
	"o":[56, 68, 68, 68, 56],
	"s":[72, 84, 84, 84, 32],
	"w":[60, 64, 48, 64, 60],
	"{":[0, 8, 54, 65, 0],
	"\"":[0, 7, 0, 7, 0],
	"&":[54, 73, 85, 34, 80],
	"*":[8, 42, 28, 42, 8],
	".":[0, 96, 96, 0, 0],
	"2":[66, 97, 81, 73, 70],
	"6":[60, 74, 73, 73, 48],
	":":[0, 54, 54, 0, 0],
	">":[65, 34, 20, 8, 0],
	"B":[127, 73, 73, 73, 54],
	"F":[127, 9, 9, 1, 1],
	"J":[32, 64, 65, 63, 1],
	"N":[127, 4, 8, 16, 127],
	"R":[127, 9, 25, 41, 70],
	"V":[31, 32, 64, 32, 31],
	"Z":[97, 81, 73, 69, 67],
	"^":[4, 2, 1, 2, 4],
	"b":[127, 72, 68, 68, 56],
	"f":[8, 126, 9, 1, 2],
	"j":[32, 64, 68, 61, 0],
	"n":[124, 8, 4, 4, 120],
	"r":[124, 8, 4, 4, 8],
	"v":[28, 32, 64, 32, 28],
	"z":[68, 100, 84, 76, 68],
	"~":[8, 8, 42, 28, 8],
	"!":[0, 0, 95, 0, 0],
	"%":[35, 19, 8, 100, 98],
	")":[0, 65, 34, 28, 0],
	"-":[8, 8, 8, 8, 8],
	"1":[0, 66, 127, 64, 0],
	"5":[39, 69, 69, 69, 57],
	"9":[6, 73, 73, 41, 30],
	"=":[20, 20, 20, 20, 20],
	"A":[126, 17, 17, 17, 126],
	"E":[127, 73, 73, 73, 65],
	"I":[0, 65, 127, 65, 0],
	"M":[127, 2, 4, 2, 127],
	"Q":[62, 65, 81, 33, 94],
	"U":[63, 64, 64, 64, 63],
	"Y":[3, 4, 120, 4, 3],
	"]":[65, 65, 127, 0, 0],
	"a":[32, 84, 84, 84, 120],
	"e":[56, 84, 84, 84, 24],
	"i":[0, 68, 125, 64, 0],
	"m":[124, 4, 24, 4, 120],
	"q":[8, 20, 20, 24, 124],
	"u":[60, 64, 64, 32, 124],
	"y":[12, 80, 80, 80, 60],
	"}":[0, 65, 54, 8, 0]
}

def write(num_pixies, input):
	out_bytes = []
	for item in input:
		out_bytes.append(0)
		out_bytes.append(255)
		out_bytes.append(0)
		out_bytes.append(chars[item][0])
		out_bytes.append(chars[item][1])
		out_bytes.append(chars[item][2])
		out_bytes.append(chars[item][3])
		out_bytes.append(chars[item][4])

	while len(out_bytes) < 16*num_pixies:
		out_bytes.append(0)

	spi.writebytes(out_bytes)
	time.sleep(0.01)
